---
id: T-205
type: task
status: todo
priority: high
parent_spec: 002-matchmaker-service.md
---

# Join Endpoint Handler - POST /match/join

Implement the HTTP handler for adding players to the matchmaking queue.

## Sub-tasks:

- [ ] **Define JoinRequest struct** (`internal/handlers/join.go`):
  ```go
  type JoinRequest struct {
      PlayerID   string `json:"playerId"`
      PlayerName string `json:"playerName"`
      Role       string `json:"role"`
  }
  ```

- [x] **Define JoinResponse struct**:
  ```go
  type JoinResponse struct {
      Success       bool   `json:"success"`
      QueuePosition int    `json:"queuePosition"`
      TicketID      string `json:"ticketId"`
      Role          string `json:"role"`
  }
  ```

- [ ] **Implement JoinHandler struct**:
  - Reference to QueueManager
  - Constructor that accepts QueueManager

- [x] **Implement ServeHTTP or handler function**:
  - Parse JSON request body into JoinRequest
  - Validate required fields (playerId, playerName, role)
  - Validate role is "survivor" or "killer"
  - Create Player model from request
  - Call QueueManager.AddToQueue()
  - Return JoinResponse with ticket ID and position

- [x] **Implement error handling**:
  - Return 400 Bad Request for invalid JSON
  - Return 400 Bad Request for missing required fields
  - Return 400 Bad Request for invalid role value
  - Return 500 Internal Server Error for queue failures

- [x] **Add request logging**: Log join requests for debugging (player ID, role)
