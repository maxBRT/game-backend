---
id: T-207
type: task
status: todo
priority: high
parent_spec: 002-matchmaker-service.md
---

# Main Server Setup - Wire Components and Start Server

Implement the main.go entry point that initializes all components and starts the HTTP server.

## Sub-tasks:

- [ ] **Initialize QueueManager**: Create instance of QueueManager in main()

- [ ] **Initialize Matcher**:
  - Create Matcher with QueueManager reference
  - Call Start() to begin background matching goroutine

- [x] **Initialize HTTP handlers**:
  - Create JoinHandler with QueueManager reference
  - Create StatusHandler with QueueManager reference

- [x] **Set up HTTP router**:
  - Use standard library `http.ServeMux` or minimal router
  - Register `POST /match/join` route to JoinHandler
  - Register `GET /match/status/{ticketId}` route to StatusHandler
  - Handle path parameter extraction for ticketId

- [x] **Configure server settings**:
  - Set listen address (default: `:8080`)
  - Allow configuration via environment variable (e.g., `PORT`)
  - Set appropriate timeouts (read, write, idle)

- [x] **Implement graceful shutdown**:
  - Listen for SIGINT/SIGTERM signals
  - Stop Matcher goroutine
  - Shutdown HTTP server with timeout
  - Log shutdown progress

- [x] **Add startup logging**:
  - Log server address on startup
  - Log when matcher goroutine starts
  - Log configuration values

- [ ] **Add health check endpoint** (optional but recommended):
  - `GET /health` returns 200 OK
  - Useful for container orchestration
